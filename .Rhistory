##### Shootings #####
ggplot() +
geom_sf(data = water_rect, color = "transparent", fill = "lightblue2") +
geom_sf(data = basemap, fill = "gray95", color = "gray90") +
geom_sf(data = census, fill = "gray85", color = "gray90") +
annotate("text", x = 2700000, y = 290000, label = "Elkins Park", size = 6, color = "gray85") +
annotate("text", x = 2715000, y = 233000, label = "Camden", size = 6, color = "gray85") +
geom_sf(data = shootings, aes(color = "1 Shooting Victim"), alpha = 0.4) +
scale_color_manual(name = "", values = "orange") +
theme_void() +
theme(legend.position = c(0.8, 0.2),
text = element_text(color = "gray40"))
#### 4 MAPPING ####
##### Shootings #####
ggplot() +
geom_sf(data = water_rect, color = "transparent", fill = "lightblue2") +
geom_sf(data = basemap, fill = "gray95", color = "gray90") +
geom_sf(data = census, fill = "gray85", color = "gray90") +
annotate("text", x = 2700000, y = 290000, label = "Elkins Park", size = 4) +
annotate("text", x = 2715000, y = 233000, label = "Camden", size = 4) +
geom_sf(data = shootings, aes(color = "1 Shooting Victim"), alpha = 0.4) +
scale_color_manual(name = "", values = "orange") +
theme_void() +
theme(legend.position = c(0.8, 0.2),
text = element_text(color = "gray40"))
#### 4 MAPPING ####
##### Shootings #####
ggplot() +
geom_sf(data = water_rect, color = "transparent", fill = "lightblue2") +
geom_sf(data = basemap, fill = "gray95", color = "gray90") +
geom_sf(data = census, fill = "gray85", color = "gray90") +
annotate("text", x = 2700000, y = 290000, label = "Elkins Park", size = 4) +
annotate("text", x = 2715000, y = 233000, label = "Camden", size = 4) +
geom_sf(data = shootings, aes(color = "1 Shooting Victim"), alpha = 0.4) +
scale_color_manual(name = "", values = "orange") +
theme_void() +
theme(legend.position = c(0.8, 0.2),
text = element_text(color = "gray40"))
#### 4 MAPPING ####
##### Shootings #####
ggplot() +
geom_sf(data = water_rect, color = "transparent", fill = "lightblue2") +
geom_sf(data = basemap, fill = "gray95", color = "gray90") +
geom_sf(data = census, fill = "gray85", color = "gray90") +
annotate("text", x = 2700000, y = 290000, label = "Elkins Park", size = 4) +
annotate("text", x = 2715000, y = 233000, label = "Camden", size = 4) +
geom_sf(data = shootings, aes(color = "1 Shooting Victim"), alpha = 0.4) +
scale_color_manual(name = "", values = "orange") +
theme_void() +
theme(legend.position = c(0.8, 0.2),
text = element_text(color = "gray40"),
annotation = element_text(color = "gray40"))
#### 4 MAPPING ####
##### Shootings #####
ggplot() +
geom_sf(data = water_rect, color = "transparent", fill = "lightblue2") +
geom_sf(data = basemap, fill = "gray95", color = "gray90") +
geom_sf(data = census, fill = "gray85", color = "gray90") +
annotate("text", x = 2700000, y = 290000, label = "Elkins Park", size = 4, color = "gray85") +
annotate("text", x = 2715000, y = 233000, label = "Camden", size = 4, color = "gray85") +
geom_sf(data = shootings, aes(color = "1 Shooting Victim"), alpha = 0.4) +
scale_color_manual(name = "", values = "orange") +
theme_void() +
theme(legend.position = c(0.8, 0.2),
text = element_text(color = "gray40"))
??annotate()
#### 4 MAPPING ####
##### Shootings #####
ggplot() +
geom_sf(data = water_rect, color = "transparent", fill = "lightblue2") +
geom_sf(data = basemap, fill = "gray95", color = "gray90") +
geom_sf(data = census, fill = "gray85", color = "gray90") +
annotate("text", x = 2700000, y = 290000, label = "Elkins Park", size = 4, color = "gray85") +
annotate("text", x = 2715000, y = 233000, label = "Camden", size = 4, color = "gray85") +
geom_sf(data = shootings, aes(color = "1 Shooting Victim"), alpha = 0.4) +
scale_color_manual(name = "", values = "orange") +
theme_void() +
theme(legend.position = c(0.8, 0.2),
text = element_text(color = "gray40"))
#### 4 MAPPING ####
##### Shootings #####
ggplot() +
geom_sf(data = water_rect, color = "transparent", fill = "lightblue2") +
geom_sf(data = basemap, fill = "gray95", color = "gray90") +
geom_sf(data = census, fill = "gray85", color = "gray90") +
annotate("text", x = 2700000, y = 290000, label = "ELKINS PARK", size = 4, color = "gray85") +
annotate("text", x = 2715000, y = 233000, label = "CAMDEN", size = 4, color = "gray85") +
annotate("text", x = 2615000, y = 260000, label = "BALA CYNWYD", size = 4, color = "gray85") +
geom_sf(data = shootings, aes(color = "1 Shooting Victim"), alpha = 0.4) +
scale_color_manual(name = "", values = "orange") +
theme_void() +
theme(legend.position = c(0.8, 0.2),
text = element_text(color = "gray40"))
#### 4 MAPPING ####
##### Shootings #####
ggplot() +
geom_sf(data = water_rect, color = "transparent", fill = "lightblue2") +
geom_sf(data = basemap, fill = "gray95", color = "gray90") +
geom_sf(data = census, fill = "gray85", color = "gray90") +
annotate("text", x = 2700000, y = 290000, label = "ELKINS PARK", size = 4, color = "gray85") +
annotate("text", x = 2715000, y = 233000, label = "CAMDEN", size = 4, color = "gray85") +
annotate("text", x = 2650000, y = 260000, label = "BALA CYNWYD", size = 4, color = "gray85") +
geom_sf(data = shootings, aes(color = "1 Shooting Victim"), alpha = 0.4) +
scale_color_manual(name = "", values = "orange") +
theme_void() +
theme(legend.position = c(0.8, 0.2),
text = element_text(color = "gray40"))
#### 4 MAPPING ####
##### Shootings #####
ggplot() +
geom_sf(data = water_rect, color = "transparent", fill = "lightblue2") +
geom_sf(data = basemap, fill = "gray95", color = "gray90") +
geom_sf(data = census, fill = "gray85", color = "gray90") +
annotate("text", x = 2700000, y = 290000, label = "ELKINS PARK", size = 4, color = "gray85") +
annotate("text", x = 2715000, y = 233000, label = "CAMDEN", size = 4, color = "gray85") +
annotate("text", x = 2680000, y = 260000, label = "BALA CYNWYD", size = 4, color = "gray85") +
geom_sf(data = shootings, aes(color = "1 Shooting Victim"), alpha = 0.4) +
scale_color_manual(name = "", values = "orange") +
theme_void() +
theme(legend.position = c(0.8, 0.2),
text = element_text(color = "gray40"))
#### 4 MAPPING ####
##### Shootings #####
ggplot() +
geom_sf(data = water_rect, color = "transparent", fill = "lightblue2") +
geom_sf(data = basemap, fill = "gray95", color = "gray90") +
geom_sf(data = census, fill = "gray85", color = "gray90") +
annotate("text", x = 2700000, y = 290000, label = "ELKINS PARK", size = 4, color = "gray85") +
annotate("text", x = 2715000, y = 233000, label = "CAMDEN", size = 4, color = "gray85") +
annotate("text", x = 2660000, y = 260000, label = "BALA CYNWYD", size = 4, color = "gray85") +
geom_sf(data = shootings, aes(color = "1 Shooting Victim"), alpha = 0.4) +
scale_color_manual(name = "", values = "orange") +
theme_void() +
theme(legend.position = c(0.8, 0.2),
text = element_text(color = "gray40"))
#### 4 MAPPING ####
##### Shootings #####
ggplot() +
geom_sf(data = water_rect, color = "transparent", fill = "lightblue2") +
geom_sf(data = basemap, fill = "gray95", color = "gray90") +
geom_sf(data = census, fill = "gray85", color = "gray90") +
annotate("text", x = 2700000, y = 290000, label = "ELKINS PARK", size = 4, color = "gray85") +
annotate("text", x = 2715000, y = 233000, label = "CAMDEN", size = 4, color = "gray85") +
annotate("text", x = 2670000, y = 260000, label = "BALA CYNWYD", size = 4, color = "gray85") +
geom_sf(data = shootings, aes(color = "1 Shooting Victim"), alpha = 0.4) +
scale_color_manual(name = "", values = "orange") +
theme_void() +
theme(legend.position = c(0.8, 0.2),
text = element_text(color = "gray40"))
#### 4 MAPPING ####
##### Shootings #####
ggplot() +
geom_sf(data = water_rect, color = "transparent", fill = "lightblue2") +
geom_sf(data = basemap, fill = "gray95", color = "gray90") +
geom_sf(data = census, fill = "gray85", color = "gray90") +
annotate("text", x = 2700000, y = 290000, label = "ELKINS PARK", size = 4, color = "gray85") +
annotate("text", x = 2715000, y = 233000, label = "CAMDEN", size = 4, color = "gray85") +
annotate("text", x = 2670000, y = 259000, label = "BALA CYNWYD", size = 4, color = "gray85") +
geom_sf(data = shootings, aes(color = "1 Shooting Victim"), alpha = 0.4) +
scale_color_manual(name = "", values = "orange") +
theme_void() +
theme(legend.position = c(0.8, 0.2),
text = element_text(color = "gray40"))
#### 4 MAPPING ####
##### Shootings #####
ggplot() +
geom_sf(data = water_rect, color = "transparent", fill = "lightblue2") +
geom_sf(data = basemap, fill = "gray95", color = "gray90") +
geom_sf(data = census, fill = "gray85", color = "gray90") +
annotate("text", x = 2700000, y = 290000, label = "ELKINS PARK", size = 3, color = "gray85") +
annotate("text", x = 2715000, y = 233000, label = "CAMDEN", size = 3, color = "gray85") +
annotate("text", x = 2670000, y = 259000, label = "BALA CYNWYD", size = 3, color = "gray85") +
geom_sf(data = shootings, aes(color = "1 Shooting Victim"), alpha = 0.4) +
scale_color_manual(name = "", values = "orange") +
theme_void() +
theme(legend.position = c(0.8, 0.2),
text = element_text(color = "gray40"))
#### 4 MAPPING ####
##### Shootings #####
ggplot() +
geom_sf(data = water_rect, color = "transparent", fill = "lightblue2") +
geom_sf(data = basemap, fill = "gray95", color = "gray90") +
geom_sf(data = census, fill = "gray85", color = "gray90") +
annotate("text", x = 2700000, y = 289000, label = "ELKINS PARK", size = 3, color = "gray85") +
annotate("text", x = 2715000, y = 233000, label = "CAMDEN", size = 3, color = "gray85") +
annotate("text", x = 2670000, y = 259000, label = "BALA CYNWYD", size = 3, color = "gray85") +
geom_sf(data = shootings, aes(color = "1 Shooting Victim"), alpha = 0.4) +
scale_color_manual(name = "", values = "orange") +
theme_void() +
theme(legend.position = c(0.8, 0.2),
text = element_text(color = "gray40"))
#### 4 MAPPING ####
##### Shootings #####
ggplot() +
geom_sf(data = water_rect, color = "transparent", fill = "lightblue2") +
geom_sf(data = basemap, fill = "gray95", color = "gray90") +
geom_sf(data = census, fill = "gray85", color = "gray90") +
annotate("text", x = 2700000, y = 287000, label = "ELKINS PARK", size = 3, color = "gray85") +
annotate("text", x = 2715000, y = 233000, label = "CAMDEN", size = 3, color = "gray85") +
annotate("text", x = 2670000, y = 259000, label = "BALA CYNWYD", size = 3, color = "gray85") +
geom_sf(data = shootings, aes(color = "1 Shooting Victim"), alpha = 0.4) +
scale_color_manual(name = "", values = "orange") +
theme_void() +
theme(legend.position = c(0.8, 0.2),
text = element_text(color = "gray40"))
#### 4 MAPPING ####
##### Shootings #####
ggplot() +
geom_sf(data = water_rect, color = "transparent", fill = "lightblue2") +
geom_sf(data = basemap, fill = "gray95", color = "gray90") +
geom_sf(data = census, fill = "gray85", color = "gray90") +
annotate("text", x = 2700000, y = 286000, label = "ELKINS PARK", size = 3, color = "gray85") +
annotate("text", x = 2715000, y = 233000, label = "CAMDEN", size = 3, color = "gray85") +
annotate("text", x = 2670000, y = 259000, label = "BALA CYNWYD", size = 3, color = "gray85") +
geom_sf(data = shootings, aes(color = "1 Shooting Victim"), alpha = 0.4) +
scale_color_manual(name = "", values = "orange") +
theme_void() +
theme(legend.position = c(0.8, 0.2),
text = element_text(color = "gray40"))
#### 4 MAPPING ####
##### Shootings #####
ggplot() +
geom_sf(data = water_rect, color = "transparent", fill = "lightblue2") +
geom_sf(data = basemap, fill = "gray95", color = "gray90") +
geom_sf(data = census, fill = "gray85", color = "gray90") +
annotate("text", x = 2700000, y = 285000, label = "ELKINS PARK", size = 3, color = "gray85") +
annotate("text", x = 2715000, y = 233000, label = "CAMDEN", size = 3, color = "gray85") +
annotate("text", x = 2670000, y = 259000, label = "BALA CYNWYD", size = 3, color = "gray85") +
geom_sf(data = shootings, aes(color = "1 Shooting Victim"), alpha = 0.4) +
scale_color_manual(name = "", values = "orange") +
theme_void() +
theme(legend.position = c(0.8, 0.2),
text = element_text(color = "gray40"))
#### 4 MAPPING ####
##### Shootings #####
ggplot() +
geom_sf(data = water_rect, color = "transparent", fill = "lightblue2") +
geom_sf(data = basemap, fill = "gray95", color = "gray90") +
geom_sf(data = census, fill = "gray85", color = "gray90") +
annotate("text", x = 2700000, y = 284000, label = "ELKINS PARK", size = 3, color = "gray85") +
annotate("text", x = 2715000, y = 233000, label = "CAMDEN", size = 3, color = "gray85") +
annotate("text", x = 2670000, y = 259000, label = "BALA CYNWYD", size = 3, color = "gray85") +
geom_sf(data = shootings, aes(color = "1 Shooting Victim"), alpha = 0.4) +
scale_color_manual(name = "", values = "orange") +
theme_void() +
theme(legend.position = c(0.8, 0.2),
text = element_text(color = "gray40"))
#### 4 MAPPING ####
##### Shootings #####
ggplot() +
geom_sf(data = water_rect, color = "transparent", fill = "lightblue2") +
geom_sf(data = basemap, fill = "gray95", color = "gray90") +
geom_sf(data = census, fill = "gray85", color = "gray90") +
annotate("text", x = 2700000, y = 284000, label = "Elkins Park", size = 3, color = "gray85") +
annotate("text", x = 2715000, y = 233000, label = "Camden", size = 3, color = "gray85") +
annotate("text", x = 2670000, y = 259000, label = "Bala Cynwyd", size = 3, color = "gray85") +
geom_sf(data = shootings, aes(color = "1 Shooting Victim"), alpha = 0.4) +
scale_color_manual(name = "", values = "orange") +
theme_void() +
theme(legend.position = c(0.8, 0.2),
text = element_text(color = "gray40"))
#### 4 MAPPING ####
##### Shootings #####
ggplot() +
geom_sf(data = water_rect, color = "transparent", fill = "lightblue2") +
geom_sf(data = basemap, fill = "gray95", color = "gray90") +
geom_sf(data = census, fill = "gray85", color = "gray90") +
annotate("text", x = 2700000, y = 284000, label = "Elkins Park", size = 3, color = "gray85") +
annotate("text", x = 2715000, y = 233000, label = "Camden", size = 3, color = "gray85") +
annotate("text", x = 2670000, y = 259000, label = "Bala Cynwyd", size = 3, color = "gray85") +
geom_sf(data = shootings, aes(color = "1 Shooting Victim"), alpha = 0.4) +
scale_color_manual(name = "", values = "orange") +
theme_void() +
theme(legend.position = c(0.8, 0.2),
text = element_text(color = "gray40"))
#### 4 MAPPING ####
##### Shootings #####
ggplot() +
geom_sf(data = water_rect, color = "transparent", fill = "lightblue2") +
geom_sf(data = basemap, fill = "gray95", color = "gray90") +
geom_sf(data = census, fill = "gray85", color = "gray90") +
geom_sf(data = shootings, aes(color = "1 Shooting Victim"), alpha = 0.4) +
scale_color_manual(name = "", values = "orange") +
annotate("text", x = 2700000, y = 284000, label = "Elkins Park", size = 3, color = "gray85") +
annotate("text", x = 2715000, y = 233000, label = "Camden", size = 3, color = "gray85") +
annotate("text", x = 2670000, y = 259000, label = "Bala Cynwyd", size = 3, color = "gray85") +
theme_void() +
theme(legend.position = c(0.8, 0.2),
text = element_text(color = "gray40"))
ggsave("shooting_map.png", last_plot(), width = 8, height = 8, dpi = 'retina')
##### Amenities #####
# Restaurants
ggplot() +
geom_sf(data = water_rect, color = "transparent", fill = "lightblue2") +
geom_sf(data = basemap, fill = "gray95", color = "gray90") +
geom_sf(data = census, fill = "gray85", color = "gray90") +
geom_sf(data = restaurants, aes(color = "1 restaurant"), alpha = 0.4) +
scale_color_manual(name = "", values = "darkcyan") +
annotate("text", x = 2700000, y = 284000, label = "Elkins Park", size = 3, color = "gray85") +
annotate("text", x = 2715000, y = 233000, label = "Camden", size = 3, color = "gray85") +
annotate("text", x = 2670000, y = 259000, label = "Bala Cynwyd", size = 3, color = "gray85") +
theme_void() +
theme(legend.position = c(0.8, 0.2),
text = element_text(color = "gray40"))
ggsave("restaurant_map.png", last_plot(), width = 8, height = 8, dpi = 'retina')
# Grocery
ggplot() +
geom_sf(data = water_rect, color = "transparent", fill = "lightblue2") +
geom_sf(data = basemap, fill = "gray95", color = "gray90") +
geom_sf(data = census, fill = "gray85", color = "gray90") +
geom_sf(data = grocery, aes(color = "1 store"), alpha = 0.4) +
scale_color_manual(name = "", values = "darkcyan") +
annotate("text", x = 2700000, y = 284000, label = "Elkins Park", size = 3, color = "gray85") +
annotate("text", x = 2715000, y = 233000, label = "Camden", size = 3, color = "gray85") +
annotate("text", x = 2670000, y = 259000, label = "Bala Cynwyd", size = 3, color = "gray85") +
theme_void() +
theme(legend.position = c(0.8, 0.2),
text = element_text(color = "gray40"))
ggsave("grocery_map.png", last_plot(), width = 8, height = 8, dpi = 'retina')
# Parks
ggplot() +
geom_sf(data = water_rect, color = "transparent", fill = "lightblue2") +
geom_sf(data = basemap, fill = "gray95", color = "gray90") +
geom_sf(data = census, fill = "gray85", color = "gray90") +
geom_sf(data = parks, aes(fill = "green space"), color = "transparent") +
scale_fill_manual(name = "", values = "olivedrab") +
annotate("text", x = 2700000, y = 284000, label = "Elkins Park", size = 3, color = "gray85") +
annotate("text", x = 2715000, y = 233000, label = "Camden", size = 3, color = "gray85") +
annotate("text", x = 2670000, y = 259000, label = "Bala Cynwyd", size = 3, color = "gray85") +
theme_void() +
theme(legend.position = c(0.8, 0.2),
text = element_text(color = "gray40"))
ggsave("parks_map.png", last_plot(), width = 8, height = 8, dpi = 'retina')
##### Demographics #####
# Poverty
ggplot() +
geom_sf(data = water_rect, color = "transparent", fill = "lightblue2") +
geom_sf(data = basemap, fill = "gray95", color = "gray90") +
geom_sf(data = census, aes(fill = poverty_pct*100), color = "transparent") +
scale_fill_distiller(palette = 'YlOrBr',
breaks = c(20, 40, 60),
labels = c("20%", "40%", "60%"),
direction = 1,
na.value = "gray85") +
annotate("text", x = 2700000, y = 284000, label = "Elkins Park", size = 3, color = "gray85") +
annotate("text", x = 2715000, y = 233000, label = "Camden", size = 3, color = "gray85") +
annotate("text", x = 2670000, y = 259000, label = "Bala Cynwyd", size = 3, color = "gray85") +
labs(fill = "Percent below\npoverty line") +
theme_void() +
theme(legend.position = c(0.8, 0.2),
text = element_text(color = "gray40"))
ggsave("poverty_map.png", last_plot(), width = 8, height = 8, dpi = 'retina')
# Unemployment
ggplot() +
geom_sf(data = water_rect, color = "transparent", fill = "lightblue2") +
geom_sf(data = basemap, fill = "gray95", color = "gray90") +
geom_sf(data = census, aes(fill = unemployed_pct*100), color = "transparent") +
scale_fill_distiller(palette = 'YlOrBr',
breaks = c(4, 8, 12),
labels = c("4%", "8%", "12%"),
direction = 1,
na.value = "gray85") +
annotate("text", x = 2700000, y = 284000, label = "Elkins Park", size = 3, color = "gray85") +
annotate("text", x = 2715000, y = 233000, label = "Camden", size = 3, color = "gray85") +
annotate("text", x = 2670000, y = 259000, label = "Bala Cynwyd", size = 3, color = "gray85") +
labs(fill = "Percent\nunemployed") +
theme_void() +
theme(legend.position = c(0.8, 0.2),
text = element_text(color = "gray40"))
ggsave("unemployment_map.png", last_plot(), width = 8, height = 8, dpi = 'retina')
# Median household income
ggplot() +
geom_sf(data = water_rect, color = "transparent", fill = "lightblue2") +
geom_sf(data = basemap, fill = "gray95", color = "gray90") +
geom_sf(data = census, aes(fill = medhhinc), color = "transparent") +
scale_fill_distiller(palette = 'YlGnBu',
breaks = c(50000,  100000, 150000),
labels = c("$50k", "$100k", "$150k"),
direction = 1,
na.value="gray85") +
annotate("text", x = 2700000, y = 284000, label = "Elkins Park", size = 3, color = "gray85") +
annotate("text", x = 2715000, y = 233000, label = "Camden", size = 3, color = "gray85") +
annotate("text", x = 2670000, y = 259000, label = "Bala Cynwyd", size = 3, color = "gray85") +
labs(fill = "Med. Household\nIncome ($)") +
theme_void() +
theme(legend.position = c(0.8, 0.2),
text = element_text(color = "gray40"))
ggsave("income_map.png", last_plot(), width = 8, height = 8, dpi = 'retina')
##### Section 8 #####
# Rent limits
ggplot() +
geom_sf(data = water_rect, color = "transparent", fill = "lightblue2") +
geom_sf(data = basemap, fill = "gray95", color = "gray90") +
geom_sf(data = rent_limits %>% filter(!is.na(cost_2br)), aes(fill = as.factor(cost_2br)), color = "gray90") +
scale_fill_brewer(palette = 'YlGnBu',
labels = c("$1,476", "$1,764", "$2,124", "$2,580", "$2,820"),
direction = 1) +
annotate("text", x = 2700000, y = 284000, label = "Elkins Park", size = 3, color = "gray85") +
annotate("text", x = 2715000, y = 233000, label = "Camden", size = 3, color = "gray85") +
annotate("text", x = 2670000, y = 259000, label = "Bala Cynwyd", size = 3, color = "gray85") +
labs(fill = "2 bedroom limit") +
theme_void() +
theme(legend.position = c(0.8, 0.25),
text = element_text(color = "gray40"))
ggsave("rent_limits_map.png", last_plot(), width = 8, height = 8, dpi = 'retina')
# Opportunity and high opportunity areas
ggplot() +
geom_sf(data = water_rect, color = "transparent", fill = "lightblue2") +
geom_sf(data = basemap, fill = "gray95", color = "gray90") +
geom_sf(data = census, fill = "gray85", color = "gray90") +
geom_sf(data = rent_limits %>% filter(safmr %in% c(4, 5)), aes(fill = "Opportunity ZIP"), color = "transparent") +
scale_fill_manual(values = "darkcyan", name = "") +
annotate("text", x = 2700000, y = 284000, label = "Elkins Park", size = 3, color = "gray85") +
annotate("text", x = 2715000, y = 233000, label = "Camden", size = 3, color = "gray85") +
annotate("text", x = 2670000, y = 259000, label = "Bala Cynwyd", size = 3, color = "gray85") +
theme_void() +
theme(legend.position = c(0.8, 0.2),
legend.direction = "vertical",
text = element_text(color = "gray40"))
ggsave("opportunity_map.png", last_plot(), width = 8, height = 8, dpi = 'retina')
# Voucher households
ggplot() +
geom_sf(data = water_rect, color = "transparent", fill = "lightblue2") +
geom_sf(data = basemap, fill = "gray95", color = "gray90") +
geom_sf(data = voucher_hh, aes(fill = vouchers), color = "gray95") +
scale_fill_distiller(palette = 'YlGnBu',
direction = 1,
na.value = "gray85") +
annotate("text", x = 2700000, y = 284000, label = "Elkins Park", size = 3, color = "gray85") +
annotate("text", x = 2715000, y = 233000, label = "Camden", size = 3, color = "gray85") +
annotate("text", x = 2670000, y = 259000, label = "Bala Cynwyd", size = 3, color = "gray85") +
labs(fill = "Households\nper tract") +
theme_void() +
theme(legend.position = c(0.8, 0.2),
legend.direction = "vertical",
text = element_text(color = "gray40"))
ggsave("voucher_hh_map.png", last_plot(), width = 8, height = 8, dpi = 'retina')
# Voucher households
ggplot() +
geom_sf(data = water_rect, color = "transparent", fill = "lightblue2") +
geom_sf(data = basemap, fill = "gray95", color = "gray90") +
geom_sf(data = voucher_hh, aes(fill = vouchers), color = "gray95") +
scale_fill_distiller(palette = 'YlGnBu',
direction = 1,
na.value = "gray85") +
annotate("text", x = 2700000, y = 284000, label = "Elkins Park", size = 3, color = "gray75") +
annotate("text", x = 2715000, y = 233000, label = "Camden", size = 3, color = "gray75") +
annotate("text", x = 2670000, y = 259000, label = "Bala Cynwyd", size = 3, color = "gray75") +
labs(fill = "Households\nper tract") +
theme_void() +
theme(legend.position = c(0.8, 0.2),
legend.direction = "vertical",
text = element_text(color = "gray40"))
wave1 <- st_read("/Users/annaduan/Desktop/wave1_clean.geojson")
# Merge
wave1_coi <- st_intersection(coi, wave1)
wave1_coi_group <- wave1_coi %>%
group_by(w1_group, c5_COI_met) %>%
summarise(n = n()) %>%
st_drop_geometry() %>%
ungroup() %>%
group_by(w1_group) %>%
mutate(pct = n / sum(n) * 100)
pander(wave1_coi_group, caption = "Wave 1 COI by Voucher Group")
ggplot() +
geom_bar(data = wave1_coi_group, aes(x = w1_group, y = pct, fill = c5_COI_met), stat = "identity") +
scale_fill_brewer(palette = "Blues") +
labs(title = "Wave 1 COI by Voucher Group",
x = "Voucher Group",
y = "Percent",
fill = "Child Opportunity Score\n(metro normed)") +
theme_minimal() +
theme(legend.position = "bottom")
# Write csvs
st_write(wave1_coi, "/Users/annaduan/Desktop/wave1_coi.geojson", driver = "GeoJSON")
# Read data
coi <- st_read("/Users/annaduan/Desktop/coi_tract/1_index.csv") %>%
filter(county_name == "Philadelphia County, Pennsylvania" & year == "2021") %>%
rename(GEOID = geoid20) %>%
left_join(tracts, by = "GEOID") %>%
st_as_sf() %>%
st_transform("EPSG:2272")
# Read data
coi <- st_read("/Users/annaduan/Desktop/GitHub/phl-housing-plus/coi_tract/1_index.csv") %>%
filter(county_name == "Philadelphia County, Pennsylvania" & year == "2021") %>%
rename(GEOID = geoid20) %>%
left_join(tracts, by = "GEOID") %>%
st_as_sf() %>%
st_transform("EPSG:2272")
# Read data
coi <- st_read("/Users/annaduan/Desktop/coi_tract/1_index.csv") %>%
filter(county_name == "Philadelphia County, Pennsylvania" & year == "2021") %>%
rename(GEOID = geoid20) %>%
left_join(tracts, by = "GEOID") %>%
st_as_sf() %>%
st_transform("EPSG:2272")
phl_tracts
# Tracts
phl_tracts <- tigris::tracts(state = "PA", county = "Philadelphia", year = 2021) %>%
st_transform("EPSG:2272")
# Read data
coi <- st_read("/Users/annaduan/Desktop/coi_tract/1_index.csv") %>%
filter(county_name == "Philadelphia County, Pennsylvania" & year == "2021") %>%
rename(GEOID = geoid20) %>%
left_join(phl_tracts, by = "GEOID") %>%
st_as_sf() %>%
st_transform("EPSG:2272")
wave1 <- st_read("/Users/annaduan/Desktop/wave1_clean.geojson")
# Merge
wave1_coi <- st_intersection(coi, wave1)
# Write csvs
st_write(wave1_coi, "/Users/annaduan/Desktop/wave1_coi.csv", driver = "csv")
